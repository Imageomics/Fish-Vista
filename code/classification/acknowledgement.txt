This code was borroowed from the M2m repository at: https://github.com/alinlab/M2m
